#!/bin/bash

# Simple fuzzel power menu for LabWC, with confirmation prompts

chosen=$(printf "logout\nswitch user\nshutdown\nreboot" | fuzzel --dmenu)

confirm() {
    action=$1
    response=$(printf "no\nyes" | fuzzel --dmenu -p "Are you sure you want to $action? ")
    [ "$response" = "yes" ]
}

case "$chosen" in
  "logout")
    if confirm "log out"; then
        labwcctl exit
    fi
    ;;
  "switch user")
    if confirm "switch user"; then
        dm-tool switch-to-greeter
    fi
    ;;
  "shutdown")
    if confirm "shut down"; then
        systemctl poweroff
    fi
    ;;
  "reboot")
    if confirm "reboot"; then
        systemctl reboot
    fi
    ;;
  *)
    exit 0
    ;;
esac


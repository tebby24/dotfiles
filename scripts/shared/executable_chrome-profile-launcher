#!/usr/bin/env bash

# Accept emails as arguments
emails=("$@")

# Count how many emails we have
count=${#emails[@]}

if (( count == 0 )); then
    echo "Usage: $0 email1@gmail.com [email2@gmail.com ...]"
    exit 1
elif (( count == 1 )); then
    # Only one profile, launch it directly
    google-chrome-stable --profile-email="${emails[0]}" --new-window &
else
    # Multiple profiles: dynamically size rofi menu
    max_lines=10
    lines=$(( count < max_lines ? count : max_lines ))

    selection=$(printf "%s\n" "${emails[@]}" | rofi -dmenu -i -p "Select Chrome Profile" -l "$lines")

    if [[ -n "$selection" ]]; then
        google-chrome-stable --profile-email="$selection" --new-window &
    fi
fi
